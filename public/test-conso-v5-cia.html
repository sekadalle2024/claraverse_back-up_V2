<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Conso.js V5 - Tables CIA</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }

        h1 {
            color: #333;
            border-bottom: 3px solid #007bff;
            padding-bottom: 10px;
        }

        h2 {
            color: #555;
            margin-top: 30px;
            background: #fff;
            padding: 10px;
            border-left: 4px solid #28a745;
        }

        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        th {
            background: #007bff;
            color: white;
            font-weight: 600;
        }

        .controls {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }

        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }

        button:hover {
            background: #0056b3;
        }

        button.success {
            background: #28a745;
        }

        button.success:hover {
            background: #218838;
        }

        button.danger {
            background: #dc3545;
        }

        button.danger:hover {
            background: #c82333;
        }

        .info-box {
            background: #fff3cd;
            border: 1px solid #ffc107;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }

        .success-box {
            background: #d4edda;
            border: 1px solid #28a745;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }

        .code {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            overflow-x: auto;
        }

        .legend {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }

        .legend h3 {
            margin-top: 0;
            color: #007bff;
        }

        .legend ul {
            margin: 10px 0;
            padding-left: 20px;
        }

        .legend li {
            margin: 5px 0;
        }
    </style>
</head>

<body>
    <h1>üß™ Test Conso.js V5 - Tables CIA (Examen)</h1>

    <div class="info-box">
        <strong>üìã Objectif du Test:</strong> Valider les nouvelles fonctionnalit√©s V5 pour les tables CIA
        <ul>
            <li>‚úÖ Masquage des colonnes Reponse_cia et Remarques</li>
            <li>‚úÖ Fusion automatique des cellules Question et Ref_question</li>
            <li>‚úÖ Persistance am√©lior√©e des checkboxes</li>
        </ul>
    </div>

    <div class="controls">
        <h3>üéÆ Contr√¥les de Test</h3>
        <button onclick="testPersistence()">üß™ Test Persistance</button>
        <button onclick="saveNow()" class="success">üíæ Sauvegarder</button>
        <button onclick="restoreAll()" class="success">üîÑ Restaurer</button>
        <button onclick="getInfo()">üìä Info Stockage</button>
        <button onclick="clearAll()" class="danger">üóëÔ∏è Effacer Tout</button>
        <button onclick="location.reload()">üîÉ Recharger Page</button>
    </div>

    <div class="legend">
        <h3>üìñ L√©gende</h3>
        <ul>
            <li><strong>Colonnes Masqu√©es:</strong> Reponse_cia et Remarques (pr√©sentes dans le DOM mais invisibles)
            </li>
            <li><strong>Colonnes Fusionn√©es:</strong> Ref_question et Question (cellules fusionn√©es verticalement)</li>
            <li><strong>Checkbox Interactive:</strong> Une seule r√©ponse possible par question</li>
            <li><strong>Persistance:</strong> Les donn√©es sont sauvegard√©es automatiquement dans localStorage</li>
        </ul>
    </div>

    <!-- Test 1: Table CIA Compl√®te -->
    <div class="test-section">
        <h2>üìù Test 1: Table CIA Compl√®te (Partie 1 - Contr√¥le Interne)</h2>

        <table class="min-w-full border border-gray-200 rounded-lg">
            <thead>
                <tr>
                    <th>Ref_question</th>
                    <th>Question</th>
                    <th>Option</th>
                    <th>Reponse_user</th>
                    <th>Reponse_cia</th>
                    <th>Remarques</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Q1-CIA-P1</td>
                    <td>Quel est le principal objectif du contr√¥le interne selon le COSO?</td>
                    <td>A. Garantir la rentabilit√© de l'entreprise</td>
                    <td></td>
                    <td>Non</td>
                    <td>Incorrect - Le contr√¥le interne ne garantit pas la rentabilit√©</td>
                </tr>
                <tr>
                    <td>Q1-CIA-P1</td>
                    <td>Quel est le principal objectif du contr√¥le interne selon le COSO?</td>
                    <td>B. Assurer la conformit√© aux lois et r√®glements</td>
                    <td></td>
                    <td>Oui</td>
                    <td>Correct - C'est l'un des objectifs principaux du COSO</td>
                </tr>
                <tr>
                    <td>Q1-CIA-P1</td>
                    <td>Quel est le principal objectif du contr√¥le interne selon le COSO?</td>
                    <td>C. √âliminer tous les risques</td>
                    <td></td>
                    <td>Non</td>
                    <td>Incorrect - Le contr√¥le interne g√®re les risques, ne les √©limine pas</td>
                </tr>
                <tr>
                    <td>Q1-CIA-P1</td>
                    <td>Quel est le principal objectif du contr√¥le interne selon le COSO?</td>
                    <td>D. Augmenter le chiffre d'affaires</td>
                    <td></td>
                    <td>Non</td>
                    <td>Incorrect - Ce n'est pas l'objectif du contr√¥le interne</td>
                </tr>
            </tbody>
        </table>

        <div class="success-box">
            <strong>‚úÖ R√©sultat Attendu:</strong>
            <ul>
                <li>Colonnes "Reponse_cia" et "Remarques" masqu√©es</li>
                <li>Colonnes "Ref_question" et "Question" fusionn√©es (4 lignes ‚Üí 1 cellule)</li>
                <li>Checkboxes interactives dans "Reponse_user"</li>
                <li>Une seule checkbox peut √™tre coch√©e √† la fois</li>
            </ul>
        </div>
    </div>

    <!-- Test 2: Table CIA Partie 2 -->
    <div class="test-section">
        <h2>üìù Test 2: Table CIA (Partie 2 - Audit Interne)</h2>

        <table class="min-w-full border border-gray-200 rounded-lg">
            <thead>
                <tr>
                    <th>REF QUESTION</th>
                    <th>QUESTION</th>
                    <th>Option</th>
                    <th>Reponse user</th>
                    <th>REPONSE CIA</th>
                    <th>Remarques</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Q2-CIA-P2</td>
                    <td>Quelle est la principale diff√©rence entre audit interne et audit externe?</td>
                    <td>A. L'audit interne est ind√©pendant de l'organisation</td>
                    <td></td>
                    <td>Non</td>
                    <td>Faux - L'audit interne fait partie de l'organisation</td>
                </tr>
                <tr>
                    <td>Q2-CIA-P2</td>
                    <td>Quelle est la principale diff√©rence entre audit interne et audit externe?</td>
                    <td>B. L'audit externe est r√©alis√© par des employ√©s de l'entreprise</td>
                    <td></td>
                    <td>Non</td>
                    <td>Faux - L'audit externe est r√©alis√© par des tiers</td>
                </tr>
                <tr>
                    <td>Q2-CIA-P2</td>
                    <td>Quelle est la principale diff√©rence entre audit interne et audit externe?</td>
                    <td>C. L'audit interne rapporte √† la direction, l'externe aux parties prenantes</td>
                    <td></td>
                    <td>Oui</td>
                    <td>Correct - C'est la principale diff√©rence</td>
                </tr>
            </tbody>
        </table>

        <div class="success-box">
            <strong>‚úÖ Test des Variations:</strong> Cette table utilise des variations de noms de colonnes (majuscules,
            espaces) pour tester la robustesse du syst√®me.
        </div>
    </div>

    <!-- Test 3: Table CIA Partie 3 -->
    <div class="test-section">
        <h2>üìù Test 3: Table CIA (Partie 3 - Gestion des Risques)</h2>

        <table class="min-w-full border border-gray-200 rounded-lg">
            <thead>
                <tr>
                    <th>ref_question</th>
                    <th>question</th>
                    <th>option</th>
                    <th>reponse_user</th>
                    <th>reponse_cia</th>
                    <th>remarque</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Q3-CIA-P3</td>
                    <td>Qu'est-ce qu'un risque inh√©rent?</td>
                    <td>A. Le risque apr√®s mise en place des contr√¥les</td>
                    <td></td>
                    <td>Non</td>
                    <td>C'est le risque r√©siduel</td>
                </tr>
                <tr>
                    <td>Q3-CIA-P3</td>
                    <td>Qu'est-ce qu'un risque inh√©rent?</td>
                    <td>B. Le risque avant tout contr√¥le</td>
                    <td></td>
                    <td>Oui</td>
                    <td>Correct - Risque brut avant contr√¥les</td>
                </tr>
                <tr>
                    <td>Q3-CIA-P3</td>
                    <td>Qu'est-ce qu'un risque inh√©rent?</td>
                    <td>C. Le risque li√© aux fraudes</td>
                    <td></td>
                    <td>Non</td>
                    <td>Trop sp√©cifique</td>
                </tr>
                <tr>
                    <td>Q3-CIA-P3</td>
                    <td>Qu'est-ce qu'un risque inh√©rent?</td>
                    <td>D. Le risque de non-conformit√©</td>
                    <td></td>
                    <td>Non</td>
                    <td>Trop sp√©cifique</td>
                </tr>
            </tbody>
        </table>

        <div class="success-box">
            <strong>‚úÖ Test Minuscules:</strong> Cette table utilise des noms de colonnes en minuscules pour tester la
            d√©tection insensible √† la casse.
        </div>
    </div>

    <!-- Instructions de Test -->
    <div class="test-section">
        <h2>üß™ Instructions de Test</h2>

        <h3>1Ô∏è‚É£ Test Visuel</h3>
        <ol>
            <li>V√©rifier que les colonnes "Reponse_cia" et "Remarques" sont <strong>invisibles</strong></li>
            <li>V√©rifier que les colonnes "Ref_question" et "Question" sont <strong>fusionn√©es</strong></li>
            <li>V√©rifier que les checkboxes apparaissent dans "Reponse_user"</li>
        </ol>

        <h3>2Ô∏è‚É£ Test Interactivit√©</h3>
        <ol>
            <li>Cliquer sur une checkbox dans une table</li>
            <li>V√©rifier qu'elle se coche et que les autres se d√©cochent</li>
            <li>V√©rifier que la cellule coch√©e devient verte (#e8f5e8)</li>
        </ol>

        <h3>3Ô∏è‚É£ Test Persistance</h3>
        <ol>
            <li>Cocher plusieurs r√©ponses dans diff√©rentes tables</li>
            <li>Cliquer sur "üíæ Sauvegarder"</li>
            <li>Cliquer sur "üîÉ Recharger Page"</li>
            <li>V√©rifier que les r√©ponses coch√©es sont restaur√©es</li>
            <li>V√©rifier que les colonnes masqu√©es restent masqu√©es</li>
            <li>V√©rifier que les cellules fusionn√©es restent fusionn√©es</li>
        </ol>

        <h3>4Ô∏è‚É£ Test Console</h3>
        <div class="code">
            // Ouvrir la console (F12) et taper:

            // Test complet de persistance
            claraverseCommands.testPersistence();

            // Voir les infos de stockage
            claraverseCommands.getStorageInfo();

            // V√©rifier les colonnes masqu√©es
            document.querySelectorAll('th[data-hidden="true"]').forEach(h => {
            console.log('Colonne masqu√©e:', h.textContent);
            });

            // V√©rifier les cellules fusionn√©es
            document.querySelectorAll('td[rowspan]').forEach(cell => {
            console.log('Cellule fusionn√©e:', cell.textContent, 'rowspan:', cell.getAttribute('rowspan'));
            });

            // Activer les logs d√©taill√©s
            claraverseCommands.debug.enableVerbose();
        </div>
    </div>

    <!-- R√©sultats Attendus -->
    <div class="test-section">
        <h2>‚úÖ R√©sultats Attendus</h2>

        <h3>Colonnes Masqu√©es</h3>
        <ul>
            <li>‚úÖ "Reponse_cia" invisible mais pr√©sente dans le DOM</li>
            <li>‚úÖ "Remarques" invisible mais pr√©sente dans le DOM</li>
            <li>‚úÖ Attribut <code>data-hidden="true"</code> sur les cellules</li>
            <li>‚úÖ Style <code>display: none</code> appliqu√©</li>
        </ul>

        <h3>Cellules Fusionn√©es</h3>
        <ul>
            <li>‚úÖ "Ref_question" fusionn√©e verticalement</li>
            <li>‚úÖ "Question" fusionn√©e verticalement</li>
            <li>‚úÖ Attribut <code>rowspan</code> sur la premi√®re cellule</li>
            <li>‚úÖ Attribut <code>data-merged="true"</code> sur les autres cellules</li>
            <li>‚úÖ Texte centr√© verticalement et horizontalement</li>
        </ul>

        <h3>Checkboxes</h3>
        <ul>
            <li>‚úÖ Checkboxes cr√©√©es automatiquement dans "Reponse_user"</li>
            <li>‚úÖ Une seule checkbox coch√©e par table</li>
            <li>‚úÖ Cellule coch√©e en vert (#e8f5e8)</li>
            <li>‚úÖ √âtat sauvegard√© dans localStorage</li>
        </ul>

        <h3>Persistance</h3>
        <ul>
            <li>‚úÖ Donn√©es sauvegard√©es automatiquement apr√®s 500ms</li>
            <li>‚úÖ Restauration compl√®te apr√®s rechargement</li>
            <li>‚úÖ Colonnes masqu√©es restaur√©es</li>
            <li>‚úÖ Cellules fusionn√©es restaur√©es</li>
            <li>‚úÖ Checkboxes restaur√©es avec leur √©tat</li>
        </ul>
    </div>

    <!-- Script de Test -->
    <script src="conso.js"></script>
    <script>
        function testPersistence() {
            if (window.claraverseCommands) {
                claraverseCommands.testPersistence();
            } else {
                alert('‚ùå Conso.js non charg√©');
            }
        }

        function saveNow() {
            if (window.claraverseCommands) {
                claraverseCommands.saveAllNow();
                alert('‚úÖ Sauvegarde effectu√©e');
            } else {
                alert('‚ùå Conso.js non charg√©');
            }
        }

        function restoreAll() {
            if (window.claraverseCommands) {
                claraverseCommands.restoreAll();
                alert('‚úÖ Restauration effectu√©e');
            } else {
                alert('‚ùå Conso.js non charg√©');
            }
        }

        function getInfo() {
            if (window.claraverseCommands) {
                const info = claraverseCommands.getStorageInfo();
                console.log('üìä Informations de stockage:', info);
                alert(`üìä Stockage:\n${info.tableCount} table(s)\n${info.dataSizeKB} KB`);
            } else {
                alert('‚ùå Conso.js non charg√©');
            }
        }

        function clearAll() {
            if (confirm('‚ö†Ô∏è Effacer toutes les donn√©es sauvegard√©es?')) {
                if (window.claraverseCommands) {
                    claraverseCommands.clearAllData();
                } else {
                    alert('‚ùå Conso.js non charg√©');
                }
            }
        }

        // Afficher un message de bienvenue
        window.addEventListener('load', () => {
            setTimeout(() => {
                console.log('üéâ Test Conso.js V5 charg√©');
                console.log('üí° Commandes disponibles: claraverseCommands.help()');
                console.log('üß™ Test de persistance: claraverseCommands.testPersistence()');
            }, 2000);
        });
    </script>
</body>

</html>