<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Examen CIA - Checkboxes</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background: #f5f5f5;
        }

        h1 {
            color: #007bff;
            border-bottom: 3px solid #007bff;
            padding-bottom: 10px;
        }

        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            border: 2px solid #007bff;
            border-radius: 8px;
            overflow: hidden;
        }

        th {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }

        td {
            padding: 10px;
            border: 1px solid #ddd;
        }

        tr:nth-child(even) {
            background: #f8f9fa;
        }

        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #007bff;
            color: white;
        }

        .btn-primary:hover {
            background: #0056b3;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn-info {
            background: #17a2b8;
            color: white;
        }

        .btn-info:hover {
            background: #138496;
        }

        .status {
            padding: 15px;
            margin: 10px 0;
            border-radius: 6px;
            background: #e7f3ff;
            border-left: 4px solid #007bff;
        }

        .info-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .success-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
    </style>
</head>

<body>
    <h1>ğŸ§ª Test Examen CIA - SystÃ¨me de Checkboxes</h1>

    <div class="info-box">
        <strong>ğŸ“‹ Instructions:</strong>
        <ol>
            <li>Cliquez sur une checkbox dans la colonne "Reponse_user"</li>
            <li>VÃ©rifiez qu'une seule checkbox peut Ãªtre cochÃ©e par table</li>
            <li>Rechargez la page pour tester la persistance</li>
            <li>Les rÃ©ponses doivent Ãªtre restaurÃ©es aprÃ¨s rechargement</li>
        </ol>
    </div>

    <div class="controls">
        <button class="btn-primary" onclick="testPersistence()">ğŸ§ª Test Persistance</button>
        <button class="btn-success" onclick="saveAll()">ğŸ’¾ Sauvegarder Tout</button>
        <button class="btn-info" onclick="showStorage()">ğŸ“Š Voir Stockage</button>
        <button class="btn-danger" onclick="clearStorage()">ğŸ—‘ï¸ Effacer DonnÃ©es</button>
        <button class="btn-primary" onclick="location.reload()">ğŸ”„ Recharger Page</button>
    </div>

    <div id="status" class="status">
        â³ En attente d'initialisation...
    </div>

    <div class="test-section">
        <h2>ğŸ“ Table Examen CIA - Partie 1</h2>
        <table class="min-w-full border border-gray-200">
            <thead>
                <tr>
                    <th>Ref_question</th>
                    <th>Question</th>
                    <th>Option</th>
                    <th>Reponse_CIA</th>
                    <th>Remarques</th>
                    <th>Reponse_user</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Q1</td>
                    <td>Quelle est la dÃ©finition de l'audit interne selon l'IIA?</td>
                    <td>A</td>
                    <td>ActivitÃ© indÃ©pendante et objective</td>
                    <td>DÃ©finition officielle</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Q1</td>
                    <td>Quelle est la dÃ©finition de l'audit interne selon l'IIA?</td>
                    <td>B</td>
                    <td>ActivitÃ© de contrÃ´le financier</td>
                    <td>DÃ©finition incorrecte</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Q1</td>
                    <td>Quelle est la dÃ©finition de l'audit interne selon l'IIA?</td>
                    <td>C</td>
                    <td>ActivitÃ© de conseil uniquement</td>
                    <td>DÃ©finition incomplÃ¨te</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Q1</td>
                    <td>Quelle est la dÃ©finition de l'audit interne selon l'IIA?</td>
                    <td>D</td>
                    <td>ActivitÃ© de supervision</td>
                    <td>DÃ©finition erronÃ©e</td>
                    <td></td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="test-section">
        <h2>ğŸ“ Table Examen CIA - Partie 2</h2>
        <table class="min-w-full border border-gray-200">
            <thead>
                <tr>
                    <th>Ref_question</th>
                    <th>Question</th>
                    <th>Option</th>
                    <th>Reponse CIA</th>
                    <th>Remarques</th>
                    <th>Reponse User</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Q2</td>
                    <td>Quel est le rÃ´le principal du CAE?</td>
                    <td>A</td>
                    <td>Diriger la fonction d'audit interne</td>
                    <td>RÃ´le principal</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Q2</td>
                    <td>Quel est le rÃ´le principal du CAE?</td>
                    <td>B</td>
                    <td>GÃ©rer les finances</td>
                    <td>RÃ´le incorrect</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Q2</td>
                    <td>Quel est le rÃ´le principal du CAE?</td>
                    <td>C</td>
                    <td>Superviser les opÃ©rations</td>
                    <td>RÃ´le partiel</td>
                    <td></td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="test-section">
        <h2>ğŸ“ Table Examen CIA - Partie 3</h2>
        <table class="min-w-full border border-gray-200">
            <thead>
                <tr>
                    <th>Ref_question</th>
                    <th>Question</th>
                    <th>Option</th>
                    <th>Reponse_cia</th>
                    <th>Remarques</th>
                    <th>reponse_user</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Q3</td>
                    <td>Quelle norme dÃ©finit l'indÃ©pendance de l'audit interne?</td>
                    <td>A</td>
                    <td>Norme 1100</td>
                    <td>Norme correcte</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Q3</td>
                    <td>Quelle norme dÃ©finit l'indÃ©pendance de l'audit interne?</td>
                    <td>B</td>
                    <td>Norme 2000</td>
                    <td>Norme incorrecte</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Q3</td>
                    <td>Quelle norme dÃ©finit l'indÃ©pendance de l'audit interne?</td>
                    <td>C</td>
                    <td>Norme 1200</td>
                    <td>Norme incorrecte</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Q3</td>
                    <td>Quelle norme dÃ©finit l'indÃ©pendance de l'audit interne?</td>
                    <td>D</td>
                    <td>Norme 1300</td>
                    <td>Norme incorrecte</td>
                    <td></td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Charger le script conso.js -->
    <script src="../conso.js"></script>

    <!-- Charger le script de diagnostic -->
    <script src="diagnostic-checkboxes-cia.js"></script>

    <script>
        // Fonctions de test
        function updateStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            const colors = {
                info: '#e7f3ff',
                success: '#d4edda',
                error: '#f8d7da',
                warning: '#fff3cd'
            };
            const borderColors = {
                info: '#007bff',
                success: '#28a745',
                error: '#dc3545',
                warning: '#ffc107'
            };
            statusDiv.style.background = colors[type];
            statusDiv.style.borderLeft = `4px solid ${borderColors[type]}`;
            statusDiv.innerHTML = message;
        }

        function testPersistence() {
            console.log('ğŸ§ª TEST DE PERSISTANCE EXAMEN CIA');
            console.log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');

            if (typeof claraverseCommands !== 'undefined') {
                claraverseCommands.testPersistence();
                updateStatus('âœ… Test de persistance lancÃ© - Voir la console', 'success');
            } else {
                updateStatus('âŒ claraverseCommands non disponible', 'error');
            }
        }

        function saveAll() {
            console.log('ğŸ’¾ SAUVEGARDE DE TOUTES LES TABLES');

            if (typeof claraverseCommands !== 'undefined') {
                claraverseCommands.saveAllNow();
                updateStatus('âœ… Toutes les tables ont Ã©tÃ© sauvegardÃ©es', 'success');
            } else {
                updateStatus('âŒ claraverseCommands non disponible', 'error');
            }
        }

        function showStorage() {
            console.log('ğŸ“Š INFORMATIONS DE STOCKAGE');
            console.log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');

            if (typeof claraverseCommands !== 'undefined') {
                const info = claraverseCommands.getStorageInfo();

                let message = `ğŸ“Š Stockage: ${info.tableCount} table(s)<br>`;
                message += `ğŸ’¾ Taille: ${info.dataSizeKB} KB (${info.dataSizeMB} MB)<br>`;

                if (info.tables && info.tables.length > 0) {
                    message += `<br><strong>Tables sauvegardÃ©es:</strong><br>`;
                    info.tables.forEach(t => {
                        message += `â€¢ ${t.id}: ${t.cells} cellules, ${t.type}<br>`;
                    });
                }

                updateStatus(message, 'info');
            } else {
                updateStatus('âŒ claraverseCommands non disponible', 'error');
            }
        }

        function clearStorage() {
            if (confirm('âš ï¸ ÃŠtes-vous sÃ»r de vouloir effacer toutes les donnÃ©es sauvegardÃ©es?')) {
                if (typeof claraverseCommands !== 'undefined') {
                    localStorage.removeItem('claraverse_tables_data');
                    updateStatus('âœ… Toutes les donnÃ©es ont Ã©tÃ© effacÃ©es', 'success');
                    console.log('ğŸ—‘ï¸ DonnÃ©es effacÃ©es');
                } else {
                    updateStatus('âŒ claraverseCommands non disponible', 'error');
                }
            }
        }

        // VÃ©rifier l'initialisation
        setTimeout(() => {
            if (typeof claraverseCommands !== 'undefined') {
                updateStatus('âœ… Script Claraverse initialisÃ© avec succÃ¨s!<br>ğŸ’¡ Utilisez les boutons ci-dessus pour tester', 'success');
                console.log('âœ… Claraverse initialisÃ©');
                console.log('ğŸ’¡ Commandes disponibles: claraverseCommands.help()');
            } else {
                updateStatus('âš ï¸ Script Claraverse non initialisÃ© - VÃ©rifiez la console', 'warning');
            }
        }, 2000);

        // Log au chargement
        console.log('ğŸš€ Page de test Examen CIA chargÃ©e');
        console.log('ğŸ“‹ 3 tables de test crÃ©Ã©es avec colonnes Reponse_user');
        console.log('ğŸ’¡ Cliquez sur les checkboxes pour tester');
    </script>
</body>

</html>